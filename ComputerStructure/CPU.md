# 만화로 쉽게 배우는 CPU 정리

## 목차

1. <b>CPU는 무슨 일을 하는가?</b>
2. <b>디지털 연산</b>

<br><br><br>

## CPU는 무슨 일을 하는가?

    CPU란 Central Processing Unit의 약자로 주로 하는 일은 연산이다. => 컴퓨터가 알 수 있는 0, 1로 계산을 한다.

<br><br>

또한 CPU가 하는 연산으로는 `산술 연산`과 `논리 연산`이 있는데

- CPU가 하는 산술 연산은 +, - 뿐이다.
- 논리 연산은 0, 1를 이용한 연산이다. Ex) AND, OR, NOT

<br><br>

CPU가 제대로 동작하기 위해서는 CPU외에 다른 장치들이 필요하는데 이를 `컴퓨터의 5대 장치`라고 한다.
CPU 내부에는 제어장치와 연산장치가 들어있다.

- 제어장치: 4개의 장치들을 총괄 => CPU
- 연산장치: 연산 => CPU
- 입력장치: 외부에서 컴퓨터에게 지시를 입력 => (키보드, 마우스)
- 출력장치: 연산의 결과 값을 출력 => (모니터, 프린터)
- 기억장치: 데이터를 기억 => (SSD, HDD, RAM)

<br>

**연산장치가 제대로 동작하기 위해서는 기억장치 및 제어장치의 연대가 반드시 필요하다**

> 기억장치의 메인 메모리는 연산을 위한 데이터나 프로그램(작업 지시서)이 들어있는데 연산을 할 때 불러오거나 저장해야하기 때문에 반드시 필요하다. <br>
> 즉 제어장치는 프로그램을 통해 작업 지시서를 읽고 작업을 실행하기 위해 각 장치에게 명령을 내림

<br><br>

ALU(Arithmetic Logic Unit, 산술 논리 연산자)는 CPU의 중심에서 연산을 하는 핵심 장치이다.

![img](https://upload.wikimedia.org/wikipedia/commons/0/0f/ALU_block.gif)

입력 A, B를 넣고 연산 명령인 Opcode를 작성하면 결과 값과 결과값에 따른 상태값이 나온다.

<br>

**상태값이 왜 필요한가요?** => 주어진 조건에 맞는지의 여부를 **판단**하기 위해 사용 (은행에서 돈이 없으면?)

즉 CPU는 연산과 판단을 통해 다양한 작업을 처리할 수 있다.

<br><br>

## 디지털 연산

<br>
### 컴퓨터의 세계는 2진수

컴퓨터에서 0, 1은 상반되는 상태를 나타냄

이를 표현하기 위해 특정 기준의 전압보다 크면 1, 작으면 0으로 나타냄

고정 소수점 => 100000, 0.0000001
부동 소수점 => 10^8, 1.23 _ 10^3(가수부 _ 지수부, 가수부는 1이상 2미만으로 나타낸다)

<br>
### 논리 연산이 뭐지?

![ic](https://mblogthumb-phinf.pstatic.net/20150415_211/roboholic84_1429029554982zpIky_PNG/C26-302.PNG?type=w2)

IC(집적회로) => 은색 핀들을 통해 전기신호를 0, 1로 0, 1을 전기신호로 바꿔주며 중심부에서는 논리 연산이 행해진다. (CPU도 고도의 IC)

![ic](https://t1.daumcdn.net/cfile/blog/2015811E4A3C70BA1B)

위 그림처럼 내부에는 논리 회로를 통해 연산이 되고 결과를 출력한다.

![ic](https://mblogthumb-phinf.pstatic.net/20110814_156/pusna25_1313265257110pQM3c_PNG/%B3%ED%B8%AE%B0%D4%C0%CC%C6%AE.PNG?type=w420)

AND 회로 => 2개의 입력 모두 참값(1)이면 참 값을 반환

OR 회로 => 2개의 입력 중 하나라도 참 값이면 참 값을 반환

NOT 회로 => 1개의 입력이 참 값이면 반대 값(0)를 반환

그외에도 NOT 회로를 추가한 NAND, NOR, EXOR 회로가 있음

<br>
### 연산하는 회로

1자리 덧셈 => 반가산기
여러 자리 덧셈 => 순차 자리 올림 가산기(전가산기 여러개)
성능 개선한 여러자리 덧셈 => 자리 올림 선견 가산기(자리 올림 부분은 별도 계산)

<br>
### 기억하는 회로

CPU에도 기억장치가 있는데 이를 레지스터라고 한다.

데이터를 유지하면서 임의의 타이밍에 0과 1를 반전시키고 싶을 때 => 플립플롭 사용

플립플롭 종류

- RS 플립플롭
- D 플립플롭
- T 플립플롭

<br><br>

## 연산 명령

<br>
### 메모리와 CPU의 이모저모

메모리에는 데이터와 명령을 가지고 있으며 CPU와 상호작용을 한다.

메모리 구조 => Key-Value 형태로 Key는 `어드레스` Value는 `명령`, `데아터`가 들어있다.

`어드레스`가 있는 이유는 쉽게 메모리안에 있는 명령과 데이터를 참조할 수 있기 때문에 존재

버스 => 데이터의 통로로 어드레스버스/데이터버스 AND 외부버스/내부버스로 나뉜다.

- 어드레스버스 => CPU가 참조할 어드레스를 메모리에게 지정
- 데이터 버스 => CPU와 메모리가 데이터를 주고받는 통로
- 외부 버스 => CPU와 외부장치의 통로
- 내부 버스 => CPU의 내부를 연결하는 통로

MUX(멀티플랙서)를 통해 내부버스에서 통로를 전환 할 수 있게 해준다. => 통로를 효율적으로 이용 가능

버스폭

- 데이터버스 폭이 넓을 수록 한꺼번에 처리할 수 있는 데이터양이 커짐에 따라 성능도 좋아짐(64비트 CPU에서 64비트는 데이터버스의 폭을 의미)
- 외부데이터 버스 폭으로 얼마나 많은 데이터를 주고받을 수 있는가를 알 수 있음
- 내부데이터 버스 폭으로 얼마나 많은 데이터를 한번에 연산할 수 있는 가를 알 수 있음

R/W, L/S, I/O

R/W => Read/Write으로 하드웨어에서 읽기/쓰기를 의미 => CPU에서 메모리에 대해 읽기, 쓰기를 수행할 수 있다.
L/S => Load/Store로 소프트웨어 관점에서 사용
I/O => 입출력의미

데이터/어드레스버스 이외에 제어 신호(R/W)를 주고받는 `제어버스도 존재`

외부장치를 제어하기 위한 I/O는 I/O 포트를 통해 외부장치에게 데이터를 받거나 전달한다.

포트는 외부와 데이터를 주고받기 위한 항구의 의미로 CPU와 메모리 사이에도 존재

프로그램은 명령의 연속 => 2와 3을(오퍼랜드) 더하시오.(명령 코드) => 명령은 오퍼랜드와 명령코드로 구성

여기서 오퍼랜드는 어드레스로 지정가능 => 2번과 3번을 더하시오

또한 "더하시오"의 명령을 수행할 때 `레지스터`가 반드시 필요

레지스터 => 계산 전용 메모장인 어큐뮬레이터, 계산 외에도 여러가지 일을 하는 범용 레지스터가 존재(이외에도 더 있음)

ALU에서 N번 주소의 2와 K번 주소의 3을 각각 레지스터에 넣고 연산하여 얻은 값을 메모리나 레지스터에 저장한다.

이외에도 메모리에서 읽은 명령을 저장하는 명령 레지스터 존재

<br>

### CPU의 명령 처리 동작

![](./img/cpu.heic)

프로그램 카운터(PC) => 다음에 실행할 명령의 어드레스를 기억한다 => 어드레스 관련 계산을 한 후 어드레스 레지스터에 저장 그리고 메모리에 전달

메모리에서 받은 명령과 CPU에서의 제어 신호는 서로 다르기 때문에 메모리 -> 명령 레지스터 -> 명령 디코더를 거쳐 변환된다. => 변환된 값은 오퍼랜드와 명령코드로 구성

### 여러가지 기억 장치

메모리는 전원을 끄면 사라지지만 디스크는 전원을 꺼도 그대로 유지된다.

메모리가 크면 데이터를 처리하기 쉽고, 디스크가 크면 많은 데이터를 저장할 수 있다.

또한 디스크는 I/O를 통해 읽거나 쓸 수 있다.

![](https://blog.kakaocdn.net/dn/ccWXst/btriYnXRPH7/Xo01FLiFuCpjg0Jmh0vUIK/img.png)

RAM영역, ROM영역 I/O영역

어드레스 공간(key-value)은 CPU가 관리하는 외부 메모리의 영역 전체를 의미

이 중에서 RAM영역, ROM영역, I/O영역으로 나뉨

- RAM => 읽기/쓰기 가능. 전원이 꺼지면 데이터 사라짐
- ROM => 읽기만 가능. 전원이 꺼져도 데이터 저장 => BIOS 내장
- I/O => I/O 포트 존재

### 인터럽트란 무엇인가?

여러가지 작업을 효율적으로 진행 가능 => Ex) 중요한 정보 우선처리

우선순위가 높은 작업 수행 후 이전 작업으로 돌아가는 방법 => 스택/스택 포인터

스택 => 메인 메모리 속 일정 공간을 확보해 기억 장치로 활용 (스택 자료구조 사용)
스택 포인터(SP) => 최후로 조작한 어드레스 포인터를 기억

인터럽트 마스크 => 인터럽트를 무시할 수 있는 기능
리셋 => 마스크를 할 수 없는 입력
