## 일반적인 프로세스 메모리 모델에 대해 학습하고 정리한다.

프로세스란?

흔히 말하는 실행되고 있는 하나의 프로그램을 의미하며 각 프로세스들은 메모리 공간을 할당받는다.

가상메모리 4GB 중 상위 1GB는 커널에 나머지 3GB는 사용자에게 할당된다.

여기서 프로세스 메모리 공간은 계층 구조를 갖는다.

계층구조는 레지스터 => CPU캐시 => 메인메모리 => 보조 기억장치 => 외부기억장치 순이며 CPU로 부터 멀어질 수록
용량이 커지고 접근 속도가 느려진다.

![사진](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F245DAB3F572836C11F)

프로세스 메모리 구조는 크게 4가지로 나뉜다.

먼저 Text영억은 프로그램을 돌리기 위한 소스코드를 저장하는 영역이다.
한번 실행하면 바뀌지 않는다.

GVAR/BSS 영역은 전역변수나 정적 변수를 저장하는 영역이다.
프로그램을 처음 시작할 때 할당하고 종료될 때 할당이 해체된다.

Stack 영역은 함수가 호출 될 때 Stack 영역에 쌓이게 되며 매개변수, 리턴값, 지역변수 등이 들어가게 된다.

heap 영역은 사용자에 의해 생성된 즉, 동적할당을 받아 생성된 변수들을 저장한다.

## Node.js 에서 프로세스 메모리 관리하는 방식을 학습하고, 일반적인 메모리 모델과 차이점을 비교한다.

Node.js는 다른 언어와는 다르게 V8엔진으로 작동하는 자바스크립트 런타임언어이다. 따라서 V8엔진이 메모리 구조와 관리에 대해 알아야한다.

![사진](https://miro.medium.com/max/1584/0*SM_Ja0xN9q54Lpqf.png)

크게 스택메모리와 힙 메모리로 구성되어있다.

스택메모리는 메서드와 함수 프레임, 원시 값, 객체 포인터를 포함한 정적 데이터가 저장되는 곳이다. 일반적인 메모리와 크게 차이점이 없다.

힙메모리는 독특한 구성을 가지고 있다.

바로 New space와 Old space이다. 해당 영역은 가비지 컬렉터에 의해 관리 되는 곳이다.

처음 동적할당을 하면 New 영역에 생성이 된다. 그리고 Old 영역은 minor GC가 New 영역을 2번 돌고도 지워지지 않은 변수들을 Old영역으로 옮겨 major GC로 관리한다.

이외에 나머지 영역은 다음과 같다.

- 라지 오브젝트 영역: 다른 영역의 제한된 크기보다 큰 객체들이 살고 있는 영역이다. 각 객체는 자체 mmap 메모리 영역을 갖는다. 라지 오브젝트들은 가비지 컬렉터로 이동하지 않는다.
- 코드 영역: 실시간(JIT) 컴파일러가 컴파일된 코드들을 저장하는 곳이다. 유일하게 실행 가능한 메모리가 있는 영역이다. (코드들은 "라지 오브젝트 영역"에 할당될 수도 있고 실행도 가능하다)
- 셀 영역, 속성 셀 영역, 맵 영역: 이 영역들은 각각 Cells, PropertyCells, Maps을 포함한다. 각 영역은 모두 같은 크기의 객체들을 포함하며, 어떤 종류의 객체를 참조하는지에 대한 제약이 있어서 수집을 단순하게 만든다.

## 리눅스 운영체제를 기준으로 가상 메모리 관리 방식에 대해 학습하고 정리한다.

가상 메모리란?

메모리를 관리하는 기법 중 하나로 실제로 데이터를 저장하는 것이 아니라 주소만을 저장하여 가상으로 메모리 크기를 늘려준다.

사용하는 이유

1. 주소만을 저장하는 방식으로 논리적으로 메모리를 확장하여 사용할 수 있다.

2. 프로세스에게 동일한 공간을 주어 각 프로세스들의 가상 메모리를 신경쓰는 것이 아닌 동일한 가상메모리 하나만 신경쓰면 되어 부담이 줄어든다.

3. 메모리 관리에 효율적이다.

![이미지](https://t1.daumcdn.net/cfile/tistory/99F95038600D5C1922?original)

가상메모리는 페이징 기법과 세그멘테이션 기법을 혼용하여 메모리를 관리한다.

먼저 페이징 기법은 다음과 같다.

1. 가상 메모리가 가지는 가상 주소를 물리 주소로 바꿔줘야 한다.

2. 이 때 주소를 변환해주는 페이지 테이블이 존재(페이지 테이블을 통해 가상으로 연속적인 물리적 메모리 가능)

MMU라는 CPU의 하드웨어가 변환을 해주는데 여기서 MMU는 TLB를 참고한다.

TLB는 일종의 캐시인데 최근에 꺼내갔던 주소들을 저장한다.

만약에 찾고자 하는 주소가 있으면 바로 꺼내주고 없으면 패이지 교체 알고리즘을 사용하여 가져온다.
